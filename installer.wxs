<?xml version='1.0' encoding='windows-1252'?>
<Wix xmlns='http://schemas.microsoft.com/wix/2006/wi'
    xmlns:difx='http://schemas.microsoft.com/wix/DifxAppExtension'>

<?if $(env.DDK_ARCH) = x64 ?>
    <?define PFILESDIR = ProgramFiles64Folder ?>
    <?define SYSDIR = System64Folder ?>
<?else?>
    <?define PFILESDIR = ProgramFilesFolder ?>
    <?define SYSDIR = SystemFolder ?>
<?endif ?>

<Module
Id='XenPvDrivers'
Language='1033'
Codepage='1252'
Version='$(env.VERSION)'
>

<Package
Id='{4DC8E152-E37F-4BD9-A938-3877D6EC528C}'
Description='Xen PV drivers for Windows'
Manufacturer='Invisible Things Lab'
InstallScope='perMachine'
InstallerVersion='200'
Languages='1033'
SummaryCodepage='1252'
InstallPrivileges='elevated'
/>

<Configuration
Name='ProductFolder'
Format='Key'
Type='Identifier'
DefaultValue='QubesProgramFilesDir'
Description='Installation directory'
DisplayName='Installation directory'
/>

<Directory Id='TARGETDIR' Name='SourceDir'>
    <Directory Id='$(var.PFILESDIR)'>
        <Directory Id='ITLProgramFilesDir' Name='Invisible Things Lab'>
            <Directory Id='QubesProgramFilesDir' Name='Qubes Tools'>
                <Directory Id='DriversDir' Name='Drivers'>
                    <Directory Id='XenbusDir' Name='xenbus'>
                        <Component Id='XenbusDriver' Guid='{FAC4C476-2F1C-4970-B5E1-8FD95A9BBCB9}'>
                            <File Id='XenbusInf' Source='xenbus\xenbus\$(env.DDK_ARCH)\xenbus.inf' KeyPath='yes' />
                            <File Id='XenbusCat' Source='xenbus\xenbus\$(env.DDK_ARCH)\xenbus.cat' />
                            <File Id='XenbusSys' Source='xenbus\xenbus\$(env.DDK_ARCH)\xenbus.sys' />
                            <File Id='XenSys' Source='xenbus\xenbus\$(env.DDK_ARCH)\xen.sys' />
                            <File Id='XenfiltSys' Source='xenbus\xenbus\$(env.DDK_ARCH)\xenfilt.sys' />
                            <File Id='XenbusCoinst' Source='xenbus\xenbus\$(env.DDK_ARCH)\xenbus_coinst.dll' />
                            <difx:Driver Legacy='yes' />
                        </Component>
                    </Directory>
                    <Directory Id='XenifaceDir' Name='xeniface'>
                        <Component Id='XenifaceDriver' Guid='{D464EDB0-CF0D-4FE5-A160-210BF246C3A4}'>
                            <File Id='XenifaceInf' Source='xeniface\xeniface\$(env.DDK_ARCH)\xeniface.inf' KeyPath='yes' />
                            <File Id='XenifaceCat' Source='xeniface\xeniface\$(env.DDK_ARCH)\xeniface.cat' />
                            <File Id='XenifaceSys' Source='xeniface\xeniface\$(env.DDK_ARCH)\xeniface.sys' />
                            <File Id='LiteagentExe' Source='xeniface\xeniface\$(env.DDK_ARCH)\LiteAgent.exe' />
                            <File Id='XenifaceCoinst' Source='xeniface\xeniface\$(env.DDK_ARCH)\xeniface_coinst.dll' />
                            <difx:Driver Legacy='yes' />
                        </Component>
                    </Directory>
                    <Directory Id='XenvifDir' Name='xenvif'>
                        <Component Id='XenvifDriver' Guid='{90BC2F5A-7414-4FF6-96E4-5789DDB1AECF}'>
                            <File Id='XenvifInf' Source='xenvif\xenvif\$(env.DDK_ARCH)\xenvif.inf' KeyPath='yes' />
                            <File Id='XenvifCat' Source='xenvif\xenvif\$(env.DDK_ARCH)\xenvif.cat' />
                            <File Id='XenvifSys' Source='xenvif\xenvif\$(env.DDK_ARCH)\xenvif.sys' />
                            <File Id='XenvifCoinst' Source='xenvif\xenvif\$(env.DDK_ARCH)\xenvif_coinst.dll' />
                            <difx:Driver Legacy='yes' />
                        </Component>
                    </Directory>
                    <Directory Id='XennetDir' Name='xennet'>
                        <Component Id='XennetDriver' Guid='{AEFEC088-0B30-4EFC-8416-5E3675AC03D0}'>
                            <File Id='XennetInf' Source='xennet\xennet\$(env.DDK_ARCH)\xennet.inf' KeyPath='yes' />
                            <File Id='XennetCat' Source='xennet\xennet\$(env.DDK_ARCH)\xennet.cat' />
                            <File Id='XennetSys' Source='xennet\xennet\$(env.DDK_ARCH)\xennet.sys' />
                            <File Id='XennetCoinst' Source='xennet\xennet\$(env.DDK_ARCH)\xennet_coinst.dll' />
                            <difx:Driver Legacy='yes' />
                        </Component>
                    </Directory>
                    <Directory Id='XenvbdDir' Name='xenvbd'>
                        <Component Id='XenvbdDriver' Guid='{87BAEE21-4695-4B75-A484-0A6136B70516}'>
                            <File Id='XenvbdInf' Source='xenvbd\xenvbd\$(env.DDK_ARCH)\xenvbd.inf' KeyPath='yes' />
                            <File Id='XenvbdCat' Source='xenvbd\xenvbd\$(env.DDK_ARCH)\xenvbd.cat' />
                            <File Id='XenvbdSys' Source='xenvbd\xenvbd\$(env.DDK_ARCH)\xenvbd.sys' />
                            <File Id='XendiskSys' Source='xenvbd\xenvbd\$(env.DDK_ARCH)\xendisk.sys' />
                            <File Id='XencrshSys' Source='xenvbd\xenvbd\$(env.DDK_ARCH)\xencrsh.sys' />
                            <File Id='XenvbdCoinst' Source='xenvbd\xenvbd\$(env.DDK_ARCH)\xenvbd_coinst.dll' />
                            <difx:Driver Legacy='yes' />
                        </Component>
                    </Directory>
                </Directory>
            </Directory>
        </Directory>
    </Directory>

    <Directory Id='$(var.SYSDIR)'>
        <Component Id='XenUserDlls' Guid='{1BA9B085-AFC2-4248-9DF2-5E85692DC707}'>
            <File Id='xencontrol' Source='bin\$(env.DDK_ARCH)\xencontrol.dll' KeyPath='yes' />
            <File Id='libxenvchan' Source='bin\$(env.DDK_ARCH)\libxenvchan.dll' />
        </Component>
    </Directory>
</Directory>

</Module>
</Wix>
